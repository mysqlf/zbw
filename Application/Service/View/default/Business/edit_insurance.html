<extend name="Base/common" />
<block name="body">
    <div class="right_box overflow">
    	<div class="buttons buttons-no-pos " style="text-align: right"><a href="javascript:history.go(-1);" class="btn btn-back">返回</a></div>
        <form id="toIncreaseForm" action="{:U('Service/Business/editInsurance')}">
            <div class="msg_list">
                <h3>参保人基本信息</h3>
                <if condition="!empty($personBaseResult)">
                	<div class="fl">
                		<div class="inp_box">
		                    <label class="inp_tit">姓名：<i class="inp_tip">*</i></label>
		                    <div class="inline-block">
			                    <input type="text" name="personName" value="{$personBaseResult.person_name}" {$personBaseResult.readonly} placeholder="请输入真实姓名" class="text" required id="useName">
			                    <div class="error_text">2-20个字符，可以由中文和英文组成</div>
			                </div>
	                	</div>
	                	<div class="inp_box">
		                    <label class="inp_tit">手机号：<i class="inp_tip">*</i></label>
		                    <div class="inline-block">
			                    <input type="text" name="mobile" value="{$personBaseResult.mobile}" {$personBaseResult.readonly} placeholder="请输入正确的手机号码" class="text" required id="mobile">
			                    <div class="error_text">请输入手机号码</div>
		                    </div>
	                	</div>
	                	<div class="inp_box">
		                    <label class="inp_tit">身份证号：<i class="inp_tip">*</i></label>
		                    <div class="inline-block">
			                    <input type="text" name="cardNum" value="{$personBaseResult.card_num}" {$personBaseResult.readonly} placeholder="请输入正确的身份证号码" class="text" required id="cardNum">
			                    <div class="error_text">请输入身份证号码</div>
			                </div>
	                	</div>
	                	<div class="inp_box select_box ctiy_box">
		                    <label class="inp_tit">户口所在地：<i class="inp_tip">*</i></label>
		                    <div class="city-picker-input text">
		                        <span class="picker-txt">请选择</span>
		                        <input class="hidden-txt" type="hidden" name="residenceLocation" required value="{$personBaseResult.residence_location}"  {$personBaseResult.readonly} id="residenceLocation">
		                    </div>
	                	</div>
		                <div class="inp_box">
		                    <label class="inp_tit">户口性质：</label>
		                    <if condition="1 eq $personBaseResult['residence_type']">
			                    <div class="inp_radio active">
			                        <input type="radio" name="residenceType" value="1" checked="checked" class="residenceType" {$personBaseResult.disabled}/> 农村户口
			                    </div>
			                    <div class="inp_radio">
			                        <input type="radio" name="residenceType" value="2" class="residenceType" {$personBaseResult.disabled}/> 城镇户口
			                    </div>
			                <elseif condition="2 eq $personBaseResult['residence_type']"/>
			                    <div class="inp_radio">
			                        <input type="radio" name="residenceType" value="1" class="residenceType" {$personBaseResult.disabled}/> 农村户口
			                    </div>
			                    <div class="inp_radio active">
			                        <input type="radio" name="residenceType" value="2" checked="checked" class="residenceType" {$personBaseResult.disabled}/> 城镇户口
			                    </div>
			                <else/>
			                    <div class="inp_radio">
			                        <input type="radio" name="residenceType" value="1" class="residenceType" {$personBaseResult.disabled}/> 农村户口
			                    </div>
			                    <div class="inp_radio">
			                        <input type="radio" name="residenceType" value="2" class="residenceType" {$personBaseResult.disabled}/> 城镇户口
			                    </div>
			                </if>
		                </div>
                	</div>
                	<div class="update_img">
                		<div>
                			上传身份证：<span>( 请上传jpg/jpeg/gif/png格式的图片，大小控制在2M以内 )</span>
                		</div>
	                    
	                    <div id="filePicker" class="upload_btn">
	                    	<i class="icon icon-addImg"></i>
	                    	<div class="scale icon">正</div>
	                    </div> 
	                    <div id="filePicker2" class="upload_btn">
	                    	<i class="icon icon-addImg"></i>
	                    	<div class="scale icon">反</div>
	                    </div>
	                </div>
	            <else/>
	            	<div class="fl">
		                <div class="inp_box">
		                    <label class="inp_tit">姓名：<i class="inp_tip">*</i></label>
		                    <input type="text" name="personName" value="" placeholder="请输入真实姓名" class="text" required id="useName">
		                    <div class="error_text">2-20个字符，可以由中文和英文组成</div>
		                </div>
		                <div class="inp_box">
		                    <label class="inp_tit">手机号：<i class="inp_tip">*</i></label>
		                    <input type="text" name="mobile" value="" placeholder="请输入正确的手机号码" class="text" required id="mobile">
		                    <div class="error_text">请输入手机号码</div>
		                </div>
		                <div class="inp_box">
		                    <label class="inp_tit">身份证号：<i class="inp_tip">*</i></label>
		                    <input type="text" name="cardNum" value="" placeholder="请输入正确的身份证号码" class="text" required id="cardNum">
		                    <div class="error_text">请输入身份证号码</div>
		                </div>
		                <div class="inp_box select_box ctiy_box">
		                    <label class="inp_tit">户口所在地：<i class="inp_tip">*</i></label>
		                    <div class="city-picker-input text">
		                        <span class="picker-txt">请选择</span>
		                        <input class="hidden-txt" type="hidden" name="residenceLocation" required value="" id="residenceLocation">
		                    </div>
		                </div>
		                <div class="inp_box">
		                    <label class="inp_tit">户口性质：<i class="inp_tip">*</i></label>
		                    <div class="inp_radio active">
		                        <input type="radio" name="residenceType" value="1" checked="checked" required class="residenceType"/> 农村户口
		                    </div>
		                    <div class="inp_radio">
		                        <input type="radio" name="residenceType" value="2" required class="residenceType"/> 城镇户口
		                    </div>
		                </div>
	                </div>
	                <div class="update_img">
                		<div>
                			上传身份证：<span>( 请上传jpg/jpeg/gif/png格式的图片，大小控制在2M以内 )</span>
                		</div>
	                    <div id="filePicker" class="upload_btn">
	                    	<i class="icon icon-addImg"></i>
	                    	<div class="scale icon">正</div>
	                    </div> 
	                    <div id="filePicker2" class="upload_btn">
	                    	<i class="icon icon-addImg"></i>
	                    	<div class="scale icon">反</div>
	                    </div>
	                </div>
                </if>
            </div>
            <div class="msg_list" id="required_msg">
                <h3>套餐选择</h3>
                <div class="inp_box select_box">
                    <label class="inp_tit">服务套餐 ：<i class="inp_tip">*</i></label>
                    <div class="inline-block ipt-box">
	                    <select class="select select_vip" name="productId" required id="vip_select">
	                        <option value="">请选择</option>
	                        <if condition="$serviceProductOrderResult">
	                        	<volist name="serviceProductOrderResult.list" id="vo">
	                        		<option value="{$vo.product_id}" data-id="{$vo.id}" data-companyid="{$vo.service_company_id}" data-overtime="{$vo.overtime}" <if condition="$vo['product_id'] eq $personInsuranceInfoResult[1]['product_id']">selected="selected"</if>>{$vo.product_name}<if condition="$vo['company_name']">-{$vo['company_name']}</if>(套餐编号:{$vo.id})</option>
	                        	</volist>
	                        </if>
	                    </select>
	                    <p class="max_text"></p>
                    </div>
                </div>
                <div class="inp_box select_box">
                    <label class="inp_tit">参保地：<i class="inp_tip">*</i></label>
                    <span class="ipt-box inline-block">
                    	 <select class="select select_location" name="location" required id="location">
	                        <option value="">请选择</option>
	                        <if condition="$serviceProductOrderLocationResult['list']['warranty_location']">
	                        	<volist name="serviceProductOrderLocationResult['list']['warranty_location']" id="vo">
	                        		<option value="{$vo.location}" data-locationid="{$vo.warrantyLocationId}" data-date="{$vo.deadline.1}" data-min="{$vo.minPaymentMonth.1}" data-max="{$vo.maxPaymentMonth.1}" data-month="{$vo.paymentMonthNum.1}" data-datepro="{$vo.deadline.2}" data-minpro="{$vo.minPaymentMonth.2}" data-maxpro="{$vo.maxPaymentMonth.2}" data-monthpro="{$vo.paymentMonthNum.2}" <if condition="$vo['location'] eq $personInsuranceInfoResult[1]['template_location']">selected="selected"</if>>{$vo.locationValue}</option>
	                        	</volist>
	                        </if>
	                    </select>
	                    <p class="max_text"></p>
                    </span>
                </div>
                <div id="staff_msg" class="clearfix" style="display:block;">
                    <div class="gongjijin clearfix">
                        <div class="gongjijin_tit">
                            <span class="tit_text big_text">购买社保</span>
                            <span class="dashed_line"></span>
                        </div>
                    </div>
                    <div class="clearfix">
	                    <div id="socialType">
	                        <if condition="$templateClassifyResult[1]['list']['result'][1]">
		                        <volist name="templateClassifyResult[1]['list']['result'][1]" id="vo">
		                    		<div class="inp_box select_box">
				                        <label class="inp_tit">{$vo.name}：<i class="inp_tip">*</i></label>
				                        <span class="ipt-box inline-block">
				                        	<select class="select select_socialType" name="socialType" required="">
			                                    <option value="">请选择</option>
				                            	<volist name="vo['_child']" id="voo">
			                                    	<option value="{$voo.id}" <if condition="in_array($voo['id'],explode('|',$personInsuranceInfoResult[1]['templateRuleResult']['classify_mixed']))">selected="selected"</if>>{$voo.name}</option>
			                            		</volist>
			                                </select>
				                        </span>
		                    		</div>
			                    </volist>
			                </if>
	                    </div>
	                    <div class="inp_box select_box">
	                        <label class="inp_tit">缴费规则 ：<i class="inp_tip">*</i></label>
	                        <span class="ipt-box inline-block">
	                        	<select class="select" name="project" required id="project">
		                            <option value="">请选择</option>
				                    <volist name="templateRuleResult.1.list" id="vo">
		                            	<option value="{$vo.id}" data-minamount="{$vo.minAmount}" data-maxamount="{$vo.maxAmount}" <if condition="$vo['id'] eq $personInsuranceInfoResult[1]['rule_id']">selected="selected"</if>>{$vo.name}</option>
			                        </volist>
		                        </select>
	                        </span>
	                    </div>
	                    <div class="inp_box">
	                        <label class="inp_tit">社保基数：<i class="inp_tip">*</i></label>
	                        <div class="inline-block">
		                        <input type="text" name="socAmount" value="{$personInsuranceInfoResult[1]['amount']}" class="text " required id="socAmount"> 
		                         <p class="max_text"></p>
		                    </div>
	                    </div>
	                    <div class="inp_box">
	                        <label class="inp_tit">起缴时间：<i class="inp_tip">*</i></label>
	                        <div class="inline-block">
		                        <input type="text" disabled name="socPayDate" value="{$personInsuranceInfoResult[1]['start_month']|int_to_date=###,"-"}" placeholder="请选择起缴时间" class="text  timepicker" required data-max="{$personInsuranceInfoResult[1]['serviceProductOrderResult']['warranty_location'][$personInsuranceInfoResult[1]['templateResult']['location']]['maxPaymentMonth']}" data-min="{$personInsuranceInfoResult[1]['serviceProductOrderResult']['warranty_location'][$personInsuranceInfoResult[1]['templateResult']['location']]['minPaymentMonth']}" id="socPayDate" required="true" aria-invalid="false" readonly>
		                        <i class="icon icon-time-picker"></i>
		                        <p class="max_text"></p>
		                    </div>
	                    </div>
                    </div>
                    <div class="gongjijin clearfix">
                        <div class="gongjijin_tit">
                            <input type="checkbox" name="isBuyPro" value="1" id="isBuyPro" <if condition="$personInsuranceInfoResult[2]['id'] and 0 neq $personInsuranceInfoResult[2]['state']">checked="checked"</if> <if condition="2 eq $personInsuranceInfoResult[2]['state']">disabled="diabled"</if>>
                            <span class="tit_text">购买公积金</span>
                            <span class="dashed_line"></span>
                        </div>
                        <div class="GJJ_con" id="con_gjj">
		                    <div class="inp_box select_box">
		                        <label class="inp_tit">缴费类型 ：<i class="inp_tip">*</i></label>
		                        <span class="ipt-box inline-block">
		                        	<select class="select ignore" name="proProject" required id="proProject">
			                            <option value="">请选择</option>
					                    <volist name="templateRuleResult.2.list" id="vo">
			                            	<option value="{$vo.id}" data-minamount="{$vo.minAmount}" data-maxamount="{$vo.maxAmount}" data-id="{$vo.id}" data-personscale="{$vo.personScale}" data-companyscale="{$vo.companyScale}" <if condition="$vo['id'] eq $personInsuranceInfoResult[2]['rule_id']">selected="selected"</if>>{$vo.name}</option>
				                        </volist>
			                        </select>
		                        </span>
		                    </div>
                            <div class="inp_box">
                                <label class="inp_tit">公积金基数：<i class="inp_tip">*</i></label>
                                <div class="inline-block">
	                                <input type="text" name="proAmount" value="{$personInsuranceInfoResult[2]['amount']}" class="text  ignore" required id="proAmount">
	                                <p class="max_text"></p>
	                            </div>
                            </div>
		                  
                            <div class="inp_box clear">
                                <label class="inp_tit">单位缴纳比例：<i class="inp_tip">*</i></label>
                                <div class="inline-block">
	                                <input type="text" name="proCompanyScale" value="{$personInsuranceInfoResult[2]['paymentInfoValue']['companyScale']|trim='%'}" class="ignore text " required id="proCompanyScale">
	                               	<span class="percent">%</span>
	                                <p class="max_text"></p>
                                </div>
                            </div>
                            <div class="inp_box ">
                                <label class="inp_tit ">个人缴纳比例：<i class="inp_tip">*</i></label>
                                <div class="inline-block">
                                	<input type="text" name="proPersonScale" value="{$personInsuranceInfoResult[2]['paymentInfoValue']['personScale']|trim='%'}" class="text  ignore" required id="proPersonScale">
	                                <span class="percent">%</span>
	                                <p class="max_text"></p>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="msg_list msg_staff " id="msg_staff">
                <h3 class="no_bor">缴费信息</h3>
                <div id="msg_staff_box">
                    <div id="staffdate">
                    </div>
                    <div id="table_box"></div>
                </div>
                <div id="page_foot">
                    <div class="staff_box">
                        <div class="staff_text">
                            企业缴纳：
                            <span class="price" id="companyPrice">0.00</span>元
                        </div>
                        <div class="staff_text">
                            个人缴纳：
                            <span class="price" id="personPrice">0.00</span>元
                        </div>
                        <div class="staff_text">
                            服务费：
                            <span class="price" id="servicePrice">0.00</span>元
                        </div>
                        <div class="staff_text" >
                            总缴纳：
                            <span class="total_price" id="totalPrice">0.00</span>元
                        </div>
                        <div class="bottom_btn">缴费详情</div>
                    </div>
                </div>
            </div>
            <input type="hidden" name="isBuySoc" value="1">
            <input type="hidden" name="socRuleId" id="socRuleId" value="{$personInsuranceInfoResult[1]['rule_id']}">
            <input type="hidden" name="proRuleId" id="proRuleId" value="{$personInsuranceInfoResult[2]['rule_id']}">
            <input type="hidden" name="templateId" id="templateId" value="{$personInsuranceInfoResult[1]['templateRuleResult']['template_id']}">
            
            <input type="hidden" name="userId" id="userId" value="{:I('get.userId')}">
            <input type="hidden" name="baseId" id="baseId" value="{:I('get.baseId')}">
            <input type="hidden" name="socPiiId" id="socPiiId" value="{$personInsuranceInfoResult[1]['id']}">
            <input type="hidden" name="proPiiId" id="proPiiId" value="{$personInsuranceInfoResult[2]['id']}">
            
            <input type="hidden" name="idCardFrontFile" id="idCardFrontFile" value="{$personBaseResult['idCardImg']['idCardFront']}">
            <input type="hidden" name="idCardBackFile" id="idCardBackFile" value="{$personBaseResult['idCardImg']['idCardBack']}">
            
            <!--<input type="hidden" id="serviceProductOrderResult" value='{:json_encode($serviceProductOrderResult)}'>
            <input type="hidden" id="serviceProductOrderLocationResult" value='{:json_encode($serviceProductOrderLocationResult)}'>
            <input type="hidden" id="templateClassifyResult" value='{:json_encode($templateClassifyResult)}'> -->
            <input type="hidden" id="templateRuleResult" value='{:json_encode($templateRuleResult)}'>
            <div class="text-center">
            	<input type="button" value="保存" id="submitBtn" data-act="submit" class="btn btn-submit center-block">
            </div>
            
        </form>
    </div>
</block>
<block name="script">
    <script src="__ASSETS__/js/modules/area.js"></script>
    <script data-init="toIncrease" type="text/javascript" src="__ASSETS__/js/dist/insurance.bundle.js"></script>
</block>
